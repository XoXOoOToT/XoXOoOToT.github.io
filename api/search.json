[{"id":"bc567916c4dc0d8169bd26d18e348d36","title":"test","content":"阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n阿达达里没打算代码是老大什么地方\n","slug":"test","date":"2021-07-07T03:44:51.000Z","categories_index":"","tags_index":"Linux","author_index":"96loveslife"},{"id":"596309cd0250881615133cb44c237a29","title":"Linux常用命令","content":"\n前言在工作的时候有的时候会兼职一下运维，所以记录一下平常我平常比较常用的命令，省的在去百度之类的。\n动态扩容因为之前虚拟化服务器后，系统的分区都是采用默认的分配方式，后面发现在根目录下的容量都只有50G，而剩余动态扩容的容量都被挂载在/home下。所以需要将/home下的容量分配给/下。\n\n\n\n\n以下操作是基于 Centos7\n查看磁盘状况：   \ndf -h\n\n\n上图就是默认的分区的产生的磁盘分区的结构，可以看见/home下可用的空间为441G。\n这个时候重新分配容量的逻辑就是：\n\n将/home下的文件进行备份\n卸载/home目录（即这个逻辑卷卸载）\n删除/home逻辑卷。删除后就会有441G的空余容量，此时才开始分配容量\n将容量分配给根目录逻辑卷\n同步文件系统，完成真正的扩容\n创建/home逻辑卷，并重新挂载，再将备份还原到/home下\n\n具体操作如下：\n1、将/home下的文件进行备份\n#因为我的/run目录的可用空间4G，所以我将/home的备份文件放到/run目录下。备份路径可根据实际情况更改。\ntar  -cvf   /run/home.tar /home \n\n2、卸载/home目录\n#安装，不然fuser可能无法使用\nyum -y install psmisc\n#关闭home下的进程\nfuser -km /home/   \n#卸载home目录\numount /home       \n\n3、删除/home逻辑卷\nlvremove /dev/mapper/centos-home\n\n4、将容量分配给根目录逻辑卷\nlvextend -L +200G /dev/mapper/centos-root\t\n\n5、同步文件系统\nxfs_growfs /dev/mapper/centos-root\n\n6、创建/home逻辑卷，并重新挂载，再将备份还原到/home下\n#重建home的逻辑卷\nlvcreate -L 240G -n/dev/mapper/centos-home\t\n#创建home的文件系统\nmkfs.xfs /dev/mapper/centos-home\n#将新建的文件系统挂载到home目录下\nmount /dev/mapper/centos-home /home\t\n#恢复home目录内容\ntar -xvf /run/home.tar -C /\n\n\n\n\n\n防火墙Centos7：\n#开启80端口\nfirewall-cmd --zone=public --add-port=80/tcp --permanent\n#关闭80端口\nfirewall-cmd --zone=public --remove-port=80/tcp --permanent\n#查看80端口\nfirewall-cmd --zone=public --query-port=80/tcp --permanent\n\n#重新加载\nfirewall-cmd --reload\n#启动防火墙\nsystemctl start firewalld\n#关闭防火墙\nsystemctl stop firewalld\n#重启防火墙\nsystemctl restart firewalld\n#查看状态\nsystemctl status firewalld\n#systemctl是centos7中的命令，其实启动服务也可以使用service，在7中也是兼容这个命令的\nservice firewalld start | stop | status   \n\n#开机自启开启 | 关闭\nsystemctl enable | disable firewalld\n\n#查看所有打开的端口\nfirewall-cmd --zone=public --list-ports\n\n#开放指定端口给 指定ip访问\nfirewall-cmd --permanent --add-rich-rule=\"rule family=\"ipv4\" source address=\"1.1.1.1\" port protocol=\"tcp\" port=\"5432\" accept\"\n\n\n\n\n\n查找\ngrep forest f.txt     #文件查找\ngrep forest f.txt cpf.txt #多文件查找\ngrep ‘log’ /home/admin -r -n #目录下查找所有符合关键字的文件\ncat f.txt | grep -i shopbase \ngrep ‘shop’ /home/admin -r -n –include *.{vm,java} #指定文件后缀\ngrep ‘shop’ /home/admin -r -n –exclude *.{vm,java} #反匹配\n\n新增硬盘动态扩容到根目录给虚拟机添加硬盘\n\n\n\n\n给新增的硬盘分区进入系统。开始分区\n像这种新增的硬盘用命令 df -h 是看不到的，所以要使用fdisk -l查看。\n[root@localhost ~]# fdisk -l\n\n#这个是最早安装系统时分配的硬盘大小\nDisk /dev/sda: 17.2 GB, 17179869184 bytes, 33554432 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisk label type: dos\nDisk identifier: 0x0000d07f\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sda1   *        2048     2099199     1048576   83  Linux\n/dev/sda2         2099200    33554431    15727616   8e  Linux LVM\n\n\n#这个是我第一次新增的硬盘，这个已经扩容到根目录下了。\nDisk /dev/sdb: 17.2 GB, 17179869184 bytes, 33554432 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisk label type: dos\nDisk identifier: 0xdc58bb63\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sdb1            2048    33554431    16776192   8e  Linux LVM\n\n\n#这个是我第二次新增的硬盘，下面将把这个扩容到根目录下。记住硬盘路径 /dev/sdc，分区的时候会用到\nDisk /dev/sdc: 17.2 GB, 17179869184 bytes, 33554432 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\n\n\n#这里就是我们根目录的大小。\nDisk /dev/mapper/centos-root: 30.9 GB, 30920409088 bytes, 60391424 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\n\n#这个是交换分区的大小\nDisk /dev/mapper/centos-swap: 1719 MB, 1719664640 bytes, 3358720 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\n\n\n新增硬盘分区和扩容硬盘分区#这个对应上面的新增硬盘路径，\n[root@localhost ~]# fdisk /dev/sdc\n\n###########这边就是进入到硬盘的分区。########################333\nWelcome to fdisk (util-linux 2.23.2).\n\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n\nDevice does not contain a recognized partition table\nBuilding a new DOS disklabel with disk identifier 0x3781fe3e.\n\n###############这里是主要操作。输入m查看对应命令\nCommand (m for help): m\nCommand action\n   a   toggle a bootable flag            \n   b   edit bsd disklabel\n   c   toggle the dos compatibility flag\n   d   delete a partition\n   g   create a new empty GPT partition table\n   G   create an IRIX (SGI) partition table\n   l   list known partition types\n   m   print this menu \n   n   add a new partition                         #新增分区，这个也常用到\n   o   create a new empty DOS partition table\n   p   print the partition table                    #查看分区表。这个经常用到\n   q   quit without saving changes\n   s   create a new empty Sun disklabel\n   t   change a partition's system id              #修改分区的类型，默认是LINUX，我们等下要改成                                                     LINUX LVM(动态)\n   u   change display/entry units\n   v   verify the partition table\n   w   write table to disk and exit                #保存分区并退出\n   x   extra functionality (experts only)\n\n##############接下来开始 新建分区，输入n\nCommand (m for help): n\n##这里选择分区类型，是主分区还是扩展，我们选择主分区。\nPartition type:\n   p   primary (0 primary, 0 extended, 4 free)\n   e   extended\n###选择主分区\nSelect (default p): p\n##主分区只能有4个，因为这个我第二个分区，所以我从2开始。\nPartition number (1-4, default 1): 2\n##这个是磁盘的扇区气起始位置，默认即可\nFirst sector (2048-33554431, default 2048): \nUsing default value 2048\n##这个为磁盘扇区结束位置。默认即可\nLast sector, +sectors or +size&#123;K,M,G&#125; (2048-33554431, default 33554431): \nUsing default value 33554431\n###可以看到16G的分区已经出来了。\nPartition 2 of type Linux and of size 16 GiB is set\n\n###########这个时候查看已经建完的分区  \nCommand (m for help): p\n\nDisk /dev/sdc: 17.2 GB, 17179869184 bytes, 33554432 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisk label type: dos\nDisk identifier: 0x3781fe3e\n\n#### 这个分区已经分区完成，挂载在/dev/sdc2路径，且分区格式是LINUX，现在我们要将格式改为LVM。\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sdc2            2048    33554431    16776192   83  Linux\n\n####开始修改分区格式\nCommand (m for help): t\nSelected partition 2\n#输入 8e，修改LVM\nHex code (type L to list all codes): 8e\n#修改成功\nChanged type of partition 'Linux' to 'Linux LVM'\n##再次查看是否成功\nCommand (m for help): p\n\nDisk /dev/sdc: 17.2 GB, 17179869184 bytes, 33554432 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisk label type: dos\nDisk identifier: 0x3781fe3e\n####变成了LVM\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sdc2            2048    33554431    16776192   8e  Linux LVM\n\n###保存即可。\nCommand (m for help): w\nThe partition table has been altered!\n\nCalling ioctl() to re-read partition table.\nSyncing disks.\n############至此分区完成。\n\n\n\n\n\n\n扩容这个时候开始将刚才分完的空间扩容给根目录。\n#进入LVM模式，开始扩容\n[root@localhost ~]# lvm\n#创建pv  这个路径对应上面的路径\nlvm> pvcreate /dev/sdc2\n  Physical volume \"/dev/sdc2\" successfully created.\n##先查看一下卷组\nlvm> pvdisplay\n\n ###这里可以看到物理卷组的信息\n  --- Physical volume ---\n  PV Name               /dev/sda2\n  ###这个VG Name对应的值就是我们等下要添加的卷组，这里是centos.\n  VG Name               centos\n  PV Size               &lt;15.00 GiB / not usable 3.00 MiB\n  Allocatable           yes (but full)\n  PE Size               4.00 MiB\n  Total PE              3839\n  Free PE               0\n  Allocated PE          3839\n  PV UUID               TmCzjX-TDeL-7hNM-e4Am-5Zyv-05Hi-cuc9Lc\n   \n  --- Physical volume ---\n  PV Name               /dev/sdb1\n  VG Name               centos\n  PV Size               &lt;16.00 GiB / not usable 3.00 MiB\n  Allocatable           yes (but full)\n  PE Size               4.00 MiB\n  Total PE              4095\n  Free PE               0\n  Allocated PE          4095\n  PV UUID               Xyp72C-5CNl-Nww5-9SO1-Jncc-TX56-nfq9rR\n###往这个卷组里面添加  我们的硬盘路径。\nlvm> vgextend centos /dev/sdc2\n  Volume group \"centos\" successfully extended\n### 然后就可以把容量转给根目录。\nlvm> lvextend -L +15G /dev/mapper/centos-root\n  Size of logical volume centos/root changed from &lt;28.80 GiB (7372 extents) to &lt;43.80 GiB (11212 extents).\n  Logical volume centos/root successfully resized.\n#退出  \nlvm> quit\n\n\n##这个时候还没有真正的把容量扩过去，还需执行一个命令（这里需要根据系统文件格式来执行不同的命令）\n#我们先查看根目录的文件格式 ---》可以看到是xfs\n[root@localhost ~]# cat /etc/fstab | grep centos-root\n/dev/mapper/centos-root /                       xfs     defaults        0 0\n\n#这里就用xfs的命令来进行最后的扩容\n[root@localhost ~]#  xfs_growfs /dev/mapper/centos-root\n########结果###############\nmeta-data=/dev/mapper/centos-root isize=512    agcount=9, agsize=877824 blks\n         =                       sectsz=512   attr=2, projid32bit=1\n         =                       crc=1        finobt=0 spinodes=0\ndata     =                       bsize=4096   blocks=7548928, imaxpct=25\n         =                       sunit=0      swidth=0 blks\nnaming   =version 2              bsize=4096   ascii-ci=0 ftype=1\nlog      =internal               bsize=4096   blocks=2560, version=2\n         =                       sectsz=512   sunit=0 blks, lazy-count=1\nrealtime =none                   extsz=4096   blocks=0, rtextents=0\ndata blocks changed from 7548928 to 11481088\n########结果###############\n\n##查看是否成功，\n[root@localhost ~]# df -h\nFilesystem               Size  Used Avail Use% Mounted on\n/dev/mapper/centos-root   44G 1010M   43G   3% /\ndevtmpfs                 899M     0  899M   0% /dev\ntmpfs                    911M     0  911M   0% /dev/shm\ntmpfs                    911M  9.5M  902M   2% /run\ntmpfs                    911M     0  911M   0% /sys/fs/cgroup\n/dev/sda1               1014M  142M  873M  14% /boot\ntmpfs                    183M     0  183M   0% /run/user/0\n\n\n\n\n###查看是否添加成功\n\n###这个是还没扩容前\n[root@localhost ~]# df -h\nFilesystem               Size  Used Avail Use% Mounted on\n/dev/mapper/centos-root   29G 1010M   28G   4% /\ndevtmpfs                 899M     0  899M   0% /dev\ntmpfs                    911M     0  911M   0% /dev/shm\ntmpfs                    911M  9.5M  902M   2% /run\ntmpfs                    911M     0  911M   0% /sys/fs/cgroup\n/dev/sda1               1014M  142M  873M  14% /boot\ntmpfs                    183M     0  183M   0% /run/user/0\n\n####这个是扩容后，可以看到的确是增加了15G.\n[root@localhost ~]# df -h\nFilesystem               Size  Used Avail Use% Mounted on\n/dev/mapper/centos-root   44G 1010M   43G   3% /\ndevtmpfs                 899M     0  899M   0% /dev\ntmpfs                    911M     0  911M   0% /dev/shm\ntmpfs                    911M  9.5M  902M   2% /run\ntmpfs                    911M     0  911M   0% /sys/fs/cgroup\n/dev/sda1               1014M  142M  873M  14% /boot\ntmpfs                    183M     0  183M   0% /run/user/0\n\n\n\n\n\n新增硬盘挂载到其它目录新增硬盘可以查看6.1，操作是一样。\n硬盘分区及格式化#这个分区和第6章并无差别。\n[root@localhost ~]# fdisk /dev/sdd\nWelcome to fdisk (util-linux 2.23.2).\n\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n\nDevice does not contain a recognized partition table\nBuilding a new DOS disklabel with disk identifier 0x971a5778.\n##查看帮助\nCommand (m for help): m\nCommand action\n   a   toggle a bootable flag\n   b   edit bsd disklabel\n   c   toggle the dos compatibility flag\n   d   delete a partition\n   g   create a new empty GPT partition table\n   G   create an IRIX (SGI) partition table\n   l   list known partition types\n   m   print this menu\n   n   add a new partition\n   o   create a new empty DOS partition table\n   p   print the partition table\n   q   quit without saving changes\n   s   create a new empty Sun disklabel\n   t   change a partition's system id\n   u   change display/entry units\n   v   verify the partition table\n   w   write table to disk and exit\n   x   extra functionality (experts only)\n\n###创建新分区\nCommand (m for help): n\nPartition type:\n   p   primary (0 primary, 0 extended, 4 free)\n   e   extended\n##选择主分区\nSelect (default p): p\n##因为我上面创建了2个了，所以我选择3\nPartition number (1-4, default 1): 3\nFirst sector (2048-33554431, default 2048): \nUsing default value 2048\nLast sector, +sectors or +size&#123;K,M,G&#125; (2048-33554431, default 33554431): \nUsing default value 33554431\nPartition 3 of type Linux and of size 16 GiB is set\n\n#更改分区格式 为lvm，方便以后动态扩容。\nCommand (m for help): t\nSelected partition 3\nHex code (type L to list all codes): 8e\nChanged type of partition 'Linux' to 'Linux LVM'\n\nCommand (m for help): p\n\nDisk /dev/sdd: 17.2 GB, 17179869184 bytes, 33554432 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisk label type: dos\nDisk identifier: 0x971a5778\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sdd3            2048    33554431    16776192   8e  Linux LVM\n\n\n###写入 保存并退出。\nCommand (m for help): w\nThe partition table has been altered!\n\nCalling ioctl() to re-read partition table.\nSyncing disks.\n\n\n####格式化硬盘  ext4是硬盘格式。\n[root@localhost ~]# mkfs -t ext4 -c /dev/sdd3\nmke2fs 1.42.9 (28-Dec-2013)\nFilesystem label=\nOS type: Linux\nBlock size=4096 (log=2)\nFragment size=4096 (log=2)\nStride=0 blocks, Stripe width=0 blocks\n1048576 inodes, 4194048 blocks\n209702 blocks (5.00%) reserved for the super user\nFirst data block=0\nMaximum filesystem blocks=4294967296\n128 block groups\n32768 blocks per group, 32768 fragments per group\n8192 inodes per group\nSuperblock backups stored on blocks: \n\t32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, \n\t4096000\n\nChecking for bad blocks (read-only test): done                                                 \nAllocating group tables: done                            \nWriting inode tables: done                            \nCreating journal (32768 blocks): done\nWriting superblocks and filesystem accounting information:        \ndone\n\n###格式化完后，开始创建文件夹，然后挂载硬盘\n[root@localhost ~]# mkdir /mnt/sdd\n##挂载。\n[root@localhost /]# mount /dev/sdd3 /mnt/sdd\n##查看是否挂载成功\n[root@localhost /]# df -h\nFilesystem               Size  Used Avail Use% Mounted on\n/dev/mapper/centos-root   44G 1010M   43G   3% /\ndevtmpfs                 899M     0  899M   0% /dev\ntmpfs                    911M     0  911M   0% /dev/shm\ntmpfs                    911M  9.5M  902M   2% /run\ntmpfs                    911M     0  911M   0% /sys/fs/cgroup\n/dev/sda1               1014M  142M  873M  14% /boot\ntmpfs                    183M     0  183M   0% /run/user/0\n###被挂载在/mnt/sdd下\n/dev/sdd3                 16G   45M   15G   1% /mnt/sdd\n\n\n\n","slug":"Linux常用命令","date":"2021-07-07T03:08:45.000Z","categories_index":"Linux","tags_index":"Linux","author_index":"96loveslife"},{"id":"b9663f58f18133b35bfe243f3e916a80","title":"Hello World","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo new \"My New Post\"\n\nMore info: Writing\nRun server$ hexo server\n\nMore info: Server\nGenerate static files$ hexo generate\n\nMore info: Generating\nDeploy to remote sites$ hexo deploy\n\nMore info: Deployment\n","slug":"hello-world","date":"2021-07-04T16:05:59.235Z","categories_index":"Linux","tags_index":"","author_index":"96loveslife"}]